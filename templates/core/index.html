{% extends "base.html" %}
{% load static %}

{% block title %}Онлайн курси англійської мови від 180 грн/год - SPEAK UP{% endblock %}
{% block og_title %}Онлайн курси англійської мови від 180 грн/год - SPEAK UP{% endblock %}
{% block meta_description %}Онлайн курси англійської від 180 грн/год від школи Speak Up. 100,000+ випускників, гарантія результату. Для дорослих та дітей. Безкоштовне тестування!{% endblock %}
{% block og_description %}Онлайн курси англійської від 180 грн/год від школи Speak Up. 100,000+ випускників, гарантія результату. Для дорослих та дітей. Безкоштовне тестування!{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/components/parallax.css' %}">
<link rel="stylesheet" href="{% static 'css/components/hero-section.css' %}">
<link rel="stylesheet" href="{% static 'css/components/achievements.css' %}">
<link rel="stylesheet" href="{% static 'css/components/advantages-carousel.css' %}">
{% if show_pricing_instead_of_courses %}
<link rel="stylesheet" href="{% static 'css/components/pricing-accordion.css' %}">
{% else %}
<link rel="stylesheet" href="{% static 'css/components/courses-accordion.css' %}">
{% endif %}
<link rel="stylesheet" href="{% static 'css/components/testimonials.css' %}">
<link rel="stylesheet" href="{% static 'css/components/faq.css' %}">
<link rel="stylesheet" href="{% static 'css/components/consultation-form.css' %}">

<!-- STEP 8: Preload фонові зображення карток (перші 2 видно одразу на desktop) -->
<link rel="preload" as="image" href="{% static 'img/1card.webp' %}" type="image/webp">
<link rel="preload" as="image" href="{% static 'img/1card.png' %}">
<link rel="preload" as="image" href="{% static 'img/2card.webp' %}" type="image/webp">
<link rel="preload" as="image" href="{% static 'img/2card.png' %}">

<!-- STEP 8: Preload паралакс зображення (desktop + mobile) з WebP -->
<link rel="preload" as="image" href="{% static 'img/mainBackground.webp' %}" type="image/webp" media="(min-width: 768px)">
<link rel="preload" as="image" href="{% static 'img/mainBackground.png' %}" media="(min-width: 768px)">
<link rel="preload" as="image" href="{% static 'img/mainBackground_mob.webp' %}" type="image/webp" media="(max-width: 767px)">
<link rel="preload" as="image" href="{% static 'img/mainBackground_mob.png' %}" media="(max-width: 767px)">
{% endblock %}

{% block content %}
<!-- Паралакс-контейнер для статичного фону -->
<div class="parallax-container" aria-hidden="true">
  <div class="parallax-layer parallax-layer__background"></div>
</div>

<div class="hero-content">
        <!-- 1. Хіро секція -->
        <section class="hero-section glass-section">
          <div class="hero-section__header">
          <h1>Англійська від <span class="hero-section__price-accent">180 грн</span> за годину!</h1>
          <p>Гарантія переходу на наступний рівень, або займайся <span class="hero-section__free-accent">БЕЗКОШТОВНО</span> доки не здаси екзамен.</p>
          </div>

          <div class="hero-section__cta">
            <div class="hero-section__form glass-card">
              <h2 class="hero-section__form-title">Запишіться на безкоштовне пробне заняття</h2>
              {% include 'components/trial-form.html' with form=trial_form %}
            </div>

            <div class="hero-section__image">
              <img src="{% static 'img/formsSpeaky.png' %}" alt="" loading="eager" decoding="async">
            </div>
          </div>
        </section>

        <!-- 2. Досягнення -->
        <section class="achievements glass-section" id="achievements">
          <h2 class="section-title">Трохи статистики</h2>
          <div class="achievements__grid">
            {% for achievement in achievements %}
            <div class="achievement-card" data-achievement-number="{{ achievement.number }}">
              <span class="achievement-card__number" data-achievement-suffix="{{ achievement.suffix|default:'' }}"></span>
              <span class="achievement-card__label">
                {% if current_language == 'ru' and achievement.label_ru %}{{ achievement.label_ru|safe }}{% else %}{{ achievement.label_uk|safe }}{% endif %}
              </span>
            </div>
            {% endfor %}
          </div>
          <div class="achievements__cta">
            <p class="achievements__cta-text">Перевір свій рівень онлайн</p>
            <a href="{% url 'core:testing' %}" class="button button--primary">
              Почати
            </a>
          </div>
        </section>

        <!-- 3. Переваги -->
        <section class="advantages-carousel glass-section" id="advantages">
          <h2 class="section-title">Наші переваги</h2>
          <div class="advantages-carousel-wrapper">
            <div class="advantages-carousel__container">
              {% for advantage in advantages %}
              <div class="advantage-card" data-advantage-id="{{ advantage.order }}">

                <!-- ПЕРЕДНЯ СТОРОНА -->
                <div class="advantage-card__front">
                  {% if advantage.order == 1 %}
                  <div class="advantage-card__bg advantage-card__bg--static-1"></div>
                  {% elif advantage.order == 2 %}
                  <div class="advantage-card__bg advantage-card__bg--static-2"></div>
                  {% elif advantage.order == 3 %}
                  <div class="advantage-card__bg advantage-card__bg--static-3"></div>
                  {% elif advantage.order == 4 %}
                  <div class="advantage-card__bg advantage-card__bg--static-4"></div>
                  {% elif advantage.order == 5 %}
                  <div class="advantage-card__bg advantage-card__bg--static-5"></div>
                  {% elif advantage.icon %}
                  <div class="advantage-card__bg advantage-card__bg--dynamic" data-bg-image="{{ advantage.icon.url }}"></div>
                  {% else %}
                  <div class="advantage-card__bg advantage-card__bg--fallback"></div>
                  {% endif %}
                  <div class="advantage-card__overlay"></div>
                  <div class="advantage-card__content">
                    <h3 class="advantage-card__title">
                      {% if current_language == 'ru' and advantage.title_ru %}{{ advantage.title_ru }}{% else %}{{ advantage.title_uk }}{% endif %}
                    </h3>
                    {% if advantage.subtitle_uk %}
                    <p class="advantage-card__subtitle">
                      {% if current_language == 'ru' and advantage.subtitle_ru %}{{ advantage.subtitle_ru }}{% else %}{{ advantage.subtitle_uk }}{% endif %}
                    </p>
                    {% endif %}
                    <span class="advantage-card__hint">ⓘ Детальніше</span>

                    {% if advantage.footer_title_uk %}
                    <div class="advantage-card__footer">
                      <strong class="advantage-card__footer-title">
                        {% if current_language == 'ru' and advantage.footer_title_ru %}{{ advantage.footer_title_ru }}{% else %}{{ advantage.footer_title_uk }}{% endif %}
                      </strong>
                      {% if advantage.footer_text_uk %}
                      <span class="advantage-card__footer-text">
                        {% if current_language == 'ru' and advantage.footer_text_ru %}{{ advantage.footer_text_ru }}{% else %}{{ advantage.footer_text_uk }}{% endif %}
                      </span>
                      {% endif %}
                    </div>
                    {% endif %}
                  </div>
                </div>

                <!-- ЗВОРОТНА СТОРОНА -->
                <div class="advantage-card__back">
                  <ul class="advantage-card__items">
                    {% for item in advantage.items.all %}
                    <li class="advantage-item">
                      {% if item.icon_emoji %}<span class="advantage-item__icon">{{ item.icon_emoji }}</span>{% endif %}
                      <div class="advantage-item__content">
                        {% if item.title_uk %}
                        <strong class="advantage-item__title">{% if current_language == 'ru' and item.title_ru %}{{ item.title_ru }}{% else %}{{ item.title_uk }}{% endif %}:</strong>
                        {% endif %}
                        <span class="advantage-item__text">{% if current_language == 'ru' and item.text_ru %}{{ item.text_ru }}{% else %}{{ item.text_uk }}{% endif %}</span>
                      </div>
                    </li>
                    {% endfor %}
                  </ul>
                </div>

              </div>
              {% endfor %}
            </div>
            <div class="advantages-carousel-nav-wrapper">
              <button type="button" class="advantages-carousel-nav advantages-carousel-nav--prev" aria-label="Попередня перевага">
                ‹
              </button>
              <button type="button" class="advantages-carousel-nav advantages-carousel-nav--next" aria-label="Наступна перевага">
                ›
              </button>
            </div>
          </div>
        </section>

        <!-- 4. Навчальні програми / Прайс-лист -->
        {% if show_pricing_instead_of_courses %}
          {% include 'core/components/pricing-section.html' %}
        {% else %}
          <section class="courses-section glass-section" id="courses">
            <h2 class="section-title">Навчальні програми</h2>
            <div class="courses-section__grid">
              {% for category in course_categories %}
              <div class="course-category" data-category-slug="{{ category.slug }}">
                <h3 class="course-category__title">{{ category.name_uk }}</h3>
                <div class="course-accordion" data-accordion-container>
                  {% for course in category.courses.all %}
                    {% if course.is_active %}
                    <div class="course-accordion__item" data-accordion-item>
                      <button class="course-accordion__header" data-accordion-header>
                        <span class="course-accordion__title">
                          {% if current_language == 'ru' and course.title_ru %}{{ course.title_ru }}{% else %}{{ course.title_uk }}{% endif %}
                        </span>
                        <span class="course-accordion__icon" aria-hidden="true">+</span>
                      </button>
                      <div class="course-accordion__content glass-card" data-accordion-content>
                        <p class="course-accordion__short-desc">
                          {% if current_language == 'ru' and course.short_desc_ru %}{{ course.short_desc_ru }}{% else %}{{ course.short_desc_uk }}{% endif %}
                        </p>
                        <div class="course-accordion__detail">
                          {% if current_language == 'ru' and course.detail_content_ru %}{{ course.detail_content_ru|safe }}{% else %}{{ course.detail_content_uk|safe }}{% endif %}
                        </div>
                        <a href="{{ course.get_absolute_url }}" class="button button--primary">Детальніше</a>
                      </div>
                    </div>
                    {% endif %}
                  {% endfor %}
                </div>
              </div>
              {% endfor %}
            </div>
          </section>
        {% endif %}

        <!-- 5. Відгуки та FAQ -->
        <section class="testimonials-section glass-section" id="testimonials">
          <h2 class="section-title">Відгуки наших студентів</h2>
          <div class="testimonials-carousel-wrapper">
            <div class="testimonials-carousel carousel-container">
              {% for testimonial in testimonials %}
              <div class="testimonial-card glass-card carousel-item">
                <div class="testimonial-card__overlay"></div>
                <div class="testimonial-card__content">
                  <div class="testimonial-card__header">
                    <span class="testimonial-card__name">{{ testimonial.name }}</span>
                    <div class="testimonial-card__rating" aria-label="Рейтинг: {{ testimonial.rating }} з 5">
                      {% for i in "12345"|make_list %}
                        <span class="testimonial-card__star {% if forloop.counter <= testimonial.rating %}testimonial-card__star--active{% endif %}">★</span>
                      {% endfor %}
                    </div>
                  </div>
                  <p class="testimonial-card__text">{{ testimonial.text }}</p>
                  <time class="testimonial-card__date" datetime="{{ testimonial.created_at|date:'Y-m-d' }}">
                    {{ testimonial.created_at|date:'d.m.Y' }}
                  </time>
                </div>
              </div>
              {% endfor %}
            </div>
            <div class="testimonials-carousel-nav-wrapper">
              <button type="button" class="testimonials-carousel-nav testimonials-carousel-nav--prev" aria-label="Попередній відгук">
                ‹
              </button>
              <button type="button" class="testimonials-carousel-nav testimonials-carousel-nav--next" aria-label="Наступний відгук">
                ›
              </button>
            </div>
          </div>
          <button class="button button--primary" id="testimonial-modal-trigger">Залишити відгук</button>
        </section>

        <section class="faq-section glass-section" id="faq">
          <h2 class="section-title">Часті питання</h2>
          <div class="faq-grid">
            <!-- Стовпчик 1: Питання 1-4 -->
            <div class="faq-column">
              <div class="faq-accordion" data-accordion-container>
                {% for faq in faqs_column1 %}
                <div class="faq-item" data-accordion-item>
                  <button class="faq-item__header" data-accordion-header>
                    <span class="faq-item__question">
                      {% if current_language == 'ru' and faq.question_ru %}{{ faq.question_ru }}{% else %}{{ faq.question_uk }}{% endif %}
                    </span>
                    <span class="faq-item__icon" aria-hidden="true">+</span>
                  </button>
                  <div class="faq-item__content" data-accordion-content>
                    <p>
                      {% if current_language == 'ru' and faq.answer_ru %}{{ faq.answer_ru }}{% else %}{{ faq.answer_uk }}{% endif %}
                    </p>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>

            <!-- Стовпчик 2: Питання 5-8 -->
            <div class="faq-column">
              <div class="faq-accordion" data-accordion-container>
                {% for faq in faqs_column2 %}
                <div class="faq-item" data-accordion-item>
                  <button class="faq-item__header" data-accordion-header>
                    <span class="faq-item__question">
                      {% if current_language == 'ru' and faq.question_ru %}{{ faq.question_ru }}{% else %}{{ faq.question_uk }}{% endif %}
                    </span>
                    <span class="faq-item__icon" aria-hidden="true">+</span>
                  </button>
                  <div class="faq-item__content" data-accordion-content>
                    <p>
                      {% if current_language == 'ru' and faq.answer_ru %}{{ faq.answer_ru }}{% else %}{{ faq.answer_uk }}{% endif %}
                    </p>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>

            <!-- Стовпчик 3: Питання 9-12 -->
            <div class="faq-column">
              <div class="faq-accordion" data-accordion-container>
                {% for faq in faqs_column3 %}
                <div class="faq-item" data-accordion-item>
                  <button class="faq-item__header" data-accordion-header>
                    <span class="faq-item__question">
                      {% if current_language == 'ru' and faq.question_ru %}{{ faq.question_ru }}{% else %}{{ faq.question_uk }}{% endif %}
                    </span>
                    <span class="faq-item__icon" aria-hidden="true">+</span>
                  </button>
                  <div class="faq-item__content" data-accordion-content>
                    <p>
                      {% if current_language == 'ru' and faq.answer_ru %}{{ faq.answer_ru }}{% else %}{{ faq.answer_uk }}{% endif %}
                    </p>
                  </div>
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </section>

        <!-- 6. Консультація -->
        <section class="consultation-section glass-section" id="consultation">
          <h2 class="section-title">Замовити консультацію</h2>
          <div class="consultation-form glass-card">
            {% include 'core/components/consultation_form.html' with form=consultation_form %}
          </div>
        </section>
      </div>
{% endblock %}

{% block extra_js %}
<script type="module" src="{% static 'js/modules/parallax-scroll.js' %}" defer></script>
<script type="module" src="{% static 'js/modules/counter-animation.js' %}" defer></script>
<script type="module" src="{% static 'js/modules/advantages-carousel.js' %}" defer></script>
{% if show_pricing_instead_of_courses %}
<script type="module" src="{% static 'js/modules/pricing-accordion.js' %}" defer></script>
<script type="module" src="{% static 'js/modules/pricing-analytics.js' %}" defer></script>
{% else %}
<script type="module" src="{% static 'js/modules/courses-accordion.js' %}" defer></script>
{% endif %}
<script type="module" src="{% static 'js/modules/testimonials-carousel.js' %}" defer></script>
<script type="module" src="{% static 'js/modules/faq-accordion.js' %}" defer></script>
<script type="module" src="{% static 'js/modules/consultation-form.js' %}" defer></script>
<script type="module" src="{% static 'js/modules/testimonial-modal.js' %}" defer></script>
{% endblock %}

